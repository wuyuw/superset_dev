(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{1179:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return r.default.createElement("span",{className:"BootstrapSliderWrapper"},r.default.createElement(a.default,e))};var r=o(n(1)),a=o(n(1182));function o(e){return e&&e.__esModule?e:{default:e}}n(1183),n(1180)},1180:function(e,t,n){},1194:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();t.getLayer=d;var a=p(n(1)),o=p(n(0)),i=n(2667),u=p(n(2673)),l=n(2674),s=p(n(751)),f=n(2658),c=p(n(2666));function p(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n,r,a){var o=e,u=o.color_picker,l=t.data.features.map(function(e){return Object.assign({},e,{color:[u.r,u.g,u.b,255*u.a]})});if(o.js_data_mutator){var c=(0,s.default)(o.js_data_mutator);l=c(l)}return null!=a&&a.forEach(function(e){l=l.filter(e)}),new i.ScreenGridLayer(Object.assign({id:"screengrid-layer-"+o.slice_id,data:l,pickable:!0,cellSizePixels:o.grid_size,minColor:[u.r,u.g,u.b,0],maxColor:[u.r,u.g,u.b,255*u.a],outline:!1,getWeight:function(){return function(e){return e.weight||0}}()},(0,f.commonLayerProps)(o,n,r)))}var h={formData:o.default.object.isRequired,payload:o.default.object.isRequired,setControlValue:o.default.func.isRequired,viewport:o.default.object.isRequired,onAddFilter:o.default.func,setTooltip:o.default.func},v={onAddFilter:function(){return function(){}}(),setTooltip:function(){return function(){}}()},y=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state=t.getDerivedStateFromProps(e),n.getLayers=n.getLayers.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["default"].PureComponent),r(t,null,[{key:"getDerivedStateFromProps",value:function(){return function(e){var t=e.formData,n=t.time_grain_sqla||t.granularity||"PT1M",r=e.payload.data.features.map(function(e){return e.__timestamp}),a=(0,l.getPlaySliderParams)(r,n);return{start:a.start,end:a.end,getStep:a.getStep,values:a.values,disabled:a.disabled}}}()}]),r(t,[{key:"componentWillReceiveProps",value:function(){return function(e){this.setState(t.getDerivedStateFromProps(e,this.state))}}()},{key:"getLayers",value:function(){return function(e){var t=[];return e[0]===e[1]||e[1]===this.end?t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<=e[1]}):t.push(function(t){return t.__timestamp>=e[0]&&t.__timestamp<e[1]}),[d(this.props.formData,this.props.payload,this.props.onAddFilter,this.props.setTooltip,t)]}}()},{key:"render",value:function(){return function(){var e=this.props,t=e.formData,n=e.payload,r=t.autozoom?(0,f.fitViewport)(this.props.viewport,n.data.features.map(function(e){return e.position})):this.props.viewport;return a.default.createElement("div",null,a.default.createElement(u.default,{getLayers:this.getLayers,start:this.state.start,end:this.state.end,getStep:this.state.getStep,values:this.state.values,disabled:this.state.disabled,viewport:r,mapboxApiAccessToken:this.props.payload.data.mapboxApiKey,mapStyle:this.props.formData.mapbox_style,setControlValue:this.props.setControlValue,aggregation:!0}))}}()}]),t}();y.propTypes=h,y.defaultProps=v,t.default=(0,c.default)(y)},2658:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBounds=l,t.fitViewport=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{var r=l(t);return Object.assign({},e,(0,a.fitBounds)({height:e.height,width:e.width,padding:n,bounds:r}))}catch(t){return console.error("Could not auto zoom",t),e}},t.commonLayerProps=function(e,t,n){var a=e,o=void 0,u=void 0;a.js_tooltip?u=(0,i.default)(a.js_tooltip):a.line_column&&"geohash"===a.line_type&&(u=function(){return function(e){return r.default.createElement("div",null,r.default.createElement("div",null,a.line_column,": ",r.default.createElement("strong",null,e.object[a.line_column])),a.metric&&r.default.createElement("div",null,a.metric,": ",r.default.createElement("strong",null,e.object[a.metric])))}}());u&&(o=function(){return function(e){e.picked?n({content:u(e),x:e.x,y:e.y}):n(null)}}());var l=void 0;a.js_onclick_href?l=function(){return function(e){var t=(0,i.default)(a.js_onclick_href)(e);window.open(t)}}():a.table_filter&&"geohash"===a.line_type&&(l=function(){return function(e){return t(a.line_column,[e.object[a.line_column]],!1)}}());return{onClick:l,onHover:o,pickable:Boolean(o)}};var r=u(n(1)),a=n(2670),o=u(n(55)),i=u(n(751));function u(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=o.default.extent(e,function(e){return e[1]}),n=o.default.extent(e,function(e){return e[0]});return[[n[0],t[0]],[n[1],t[1]]]}},2662:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=s(n(1)),i=s(n(0)),u=s(n(2686)),l=s(n(2667));function s(e){return e&&e.__esModule?e:{default:e}}n(2688);var f={viewport:i.default.object.isRequired,layers:i.default.array.isRequired,setControlValue:i.default.func,mapStyle:i.default.string,mapboxApiAccessToken:i.default.string.isRequired,onViewportChange:i.default.func},c={mapStyle:"light",onViewportChange:function(){return function(){}}(),setControlValue:function(){return function(){}}()},p=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={viewport:e.viewport},n.tick=n.tick.bind(n),n.onViewportChange=n.onViewportChange.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["default"].Component),a(t,[{key:"componentWillMount",value:function(){return function(){var e=setInterval(this.tick,1e3);this.setState(function(){return{timer:e}})}}()},{key:"componentWillReceiveProps",value:function(){return function(e){var t=this;this.setState(function(){return{viewport:Object.assign({},e.viewport),previousViewport:t.state.viewport}})}}()},{key:"componentWillUnmount",value:function(){return function(){this.clearInterval(this.state.timer)}}()},{key:"onViewportChange",value:function(){return function(e){var t=Object.assign({},e);delete t.width,delete t.height;var n=Object.assign({},this.state.viewport,t);this.setState(function(){return{viewport:n}}),this.props.onViewportChange(n)}}()},{key:"tick",value:function(){return function(){var e=this;if(this.state.previousViewport!==this.state.viewport){var t=this.props.setControlValue,n=this.state.viewport;t&&t("viewport",n),this.setState(function(){return{previousViewport:e.state.viewport}})}}}()},{key:"layers",value:function(){return function(){return this.props.layers.some(function(e){return"function"==typeof e})?this.props.layers.map(function(e){return"function"==typeof e?e():e}):this.props.layers}}()},{key:"render",value:function(){return function(){var e=this.state.viewport;return o.default.createElement(u.default,r({},e,{mapStyle:this.props.mapStyle,onViewportChange:this.onViewportChange,mapboxApiAccessToken:this.props.mapboxApiAccessToken}),o.default.createElement(l.default,r({},e,{layers:this.layers(),initWebGLParameters:!0})))}}()}]),t}();t.default=p,p.propTypes=f,p.defaultProps=c},2666:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:i;return function(){return function(n,o,i){var l=new u(n,o,i);a.default.render(r.default.createElement(e,t(l)),document.querySelector(n.selector))}}()};var r=o(n(1)),a=o(n(10));function o(e){return e&&e.__esModule?e:{default:e}}var i=function(){return function(e){return e}}(),u=function(){return function e(t,n,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.formData=t.formData,this.payload=n,this.setControlValue=r,this.viewport=Object.assign({},this.formData.viewport,{width:t.width(),height:t.height()}),this.onAddFilter=function(){t.addFilter.apply(t,arguments)},this.setTooltip=function(){t.setTooltip.apply(t,arguments)}}}()},2673:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=s(n(1)),i=s(n(0)),u=s(n(2662)),l=s(n(2675));function s(e){return e&&e.__esModule?e:{default:e}}var f={getLayers:i.default.func.isRequired,start:i.default.number.isRequired,end:i.default.number.isRequired,getStep:i.default.func,values:i.default.array.isRequired,aggregation:i.default.bool,disabled:i.default.bool,viewport:i.default.object.isRequired,children:i.default.node},c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e)),r=(e.getLayers,e.start,e.end,e.getStep,e.values),a=(e.disabled,e.viewport),o=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(e,["getLayers","start","end","getStep","values","disabled","viewport"]);return n.state={values:r,viewport:a},n.other=o,n.onChange=n.onChange.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o["default"].Component),a(t,[{key:"componentWillReceiveProps",value:function(){return function(e){this.setState({values:e.values,viewport:e.viewport})}}()},{key:"onChange",value:function(){return function(e){this.setState({values:Array.isArray(e)?e:[e,this.props.getStep(e)]})}}()},{key:"render",value:function(){return function(){var e=this,t=this.props,n=t.start,a=t.end,i=t.getStep,s=t.disabled,f=t.aggregation,c=t.children,p=t.getLayers,d=this.state,h=d.values,v=d.viewport,y=p(h);return o.default.createElement("div",null,o.default.createElement(u.default,r({},this.other,{viewport:v,layers:y,onViewportChange:function(t){return e.setState({viewport:t})}})),!s&&o.default.createElement(l.default,{start:n,end:a,step:i(n),values:h,range:!f,onChange:this.onChange}),c)}}()}]),t}();t.default=c,c.propTypes=f,c.defaultProps={aggregation:!1,disabled:!1}},2674:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getPlaySliderParams=void 0,t.truncate=l;var r,a=n(8),o=(r=a)&&r.__esModule?r:{default:r};function i(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var u=[1,0,1,0,0,0,0];function l(e,t){var n=(0,o.default)(e).subtract(t),r=e.toArray(),a=n.toArray(),i=r.map(function(e,t){return a[t]!==e}).indexOf(!0),l=r.map(function(e,t){if(t===i){var n=e-a[t];return e-(e-u[t])%n}return t<i||-1===i?e:u[t]});return(0,o.default)(l)}t.getPlaySliderParams=function(){return function(e,t){var n=(0,o.default)(Math.min.apply(Math,i(e))),r=(0,o.default)(Math.max.apply(Math,i(e))),a=void 0,u=void 0;if(-1!==t.indexOf("/")){var s=t.split("/",2);s[0].endsWith("Z")?(u=(0,o.default)(s[0]),a=o.default.duration(s[1])):(u=(0,o.default)(s[1]),a=o.default.duration(s[0]))}else u=l(n,a=o.default.duration(t));for(var f=(0,o.default)(u);f<n;)f.add(a);for(;f>n;)f.subtract(a);for(var c=(0,o.default)(u);c>r;)c.subtract(a);for(;c<r;)c.add(a);var p=null!=t?[f,(0,o.default)(f).add(a)]:[f,c],d=e.every(function(e){return null===e});return{start:parseInt(f.format("x"),10),end:parseInt(c.format("x"),10),getStep:function(e,t){var n=parseInt((0,o.default)(t).format("x"),10);return parseInt((0,o.default)(t).add(e).format("x"),10)-n}.bind(this,a),values:p.map(function(e){return parseInt(e.format("x"),10)}),disabled:d}}}()},2675:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=f(n(1)),o=f(n(0)),i=n(14),u=f(n(1184)),l=f(n(1179));n(2676);var s=n(12);function f(e){return e&&e.__esModule?e:{default:e}}var c={start:o.default.number.isRequired,step:o.default.number.isRequired,end:o.default.number.isRequired,values:o.default.array.isRequired,onChange:o.default.func,loopDuration:o.default.number,maxFrames:o.default.number,orientation:o.default.oneOf(["horizontal","vertical"]),reversed:o.default.bool,disabled:o.default.bool,range:o.default.bool},p={onChange:function(){return function(){}}(),loopDuration:15e3,maxFrames:100,orientation:"horizontal",reversed:!1,disabled:!1,range:!0},d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));n.state={intervalId:null};var r=e.end-e.start,a=Math.min(e.maxFrames,r/e.step),o=r/a;return n.intervalMilliseconds=e.loopDuration/a,n.increment=o<e.step?e.step:o-o%e.step,n.onChange=n.onChange.bind(n),n.play=n.play.bind(n),n.pause=n.pause.bind(n),n.stepBackward=n.stepBackward.bind(n),n.stepForward=n.stepForward.bind(n),n.getPlayClass=n.getPlayClass.bind(n),n.formatter=n.formatter.bind(n),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a["default"].PureComponent),r(t,[{key:"componentDidMount",value:function(){return function(){u.default.bind(["space"],this.play)}}()},{key:"componentWillUnmount",value:function(){return function(){u.default.unbind(["space"])}}()},{key:"onChange",value:function(){return function(e){this.props.onChange(e.target.value),null!=this.state.intervalId&&this.pause()}}()},{key:"getPlayClass",value:function(){return function(){return null==this.state.intervalId?"fa fa-play fa-lg slider-button":"fa fa-pause fa-lg slider-button"}}()},{key:"play",value:function(){return function(){if(!this.props.disabled)if(null!=this.state.intervalId)this.pause();else{var e=setInterval(this.stepForward,this.intervalMilliseconds);this.setState({intervalId:e})}}}()},{key:"pause",value:function(){return function(){clearInterval(this.state.intervalId),this.setState({intervalId:null})}}()},{key:"stepForward",value:function(){return function(){var e=this,t=this.props,n=t.start,r=t.end,a=t.step,o=t.values;if(!t.disabled){var i=(Array.isArray(o)?o:[o,o+a]).map(function(t){return t+e.increment}),u=i[1]>r?i[0]-n:0;this.props.onChange(i.map(function(e){return e-u}))}}}()},{key:"stepBackward",value:function(){return function(){var e=this,t=this.props,n=t.start,r=t.end,a=t.step,o=t.values;if(!t.disabled){var i=(Array.isArray(o)?o:[o,o+a]).map(function(t){return t-e.increment}),u=i[0]<n?r-i[1]:0;this.props.onChange(i.map(function(e){return e+u}))}}}()},{key:"formatter",value:function(){return function(e){if(this.props.disabled)return(0,s.t)("Data has no time steps");var t=e;return Array.isArray(e)?e[0]===e[1]&&(t=[e[0]]):t=[e],t.map(function(e){return new Date(e).toUTCString()}).join(" : ")}}()},{key:"render",value:function(){return function(){var e=this.props,t=e.start,n=e.end,r=e.step,o=e.orientation,u=e.reversed,s=e.disabled,f=e.range,c=e.values;return a.default.createElement(i.Row,{className:"play-slider"},a.default.createElement(i.Col,{md:1,className:"padded"},a.default.createElement("i",{className:"fa fa-step-backward fa-lg slider-button ",onClick:this.stepBackward}),a.default.createElement("i",{className:this.getPlayClass(),onClick:this.play}),a.default.createElement("i",{className:"fa fa-step-forward fa-lg slider-button ",onClick:this.stepForward})),a.default.createElement(i.Col,{md:11,className:"padded"},a.default.createElement(l.default,{value:f?c:c[0],range:f,formatter:this.formatter,change:this.onChange,min:t,max:n,step:r,orientation:o,reversed:u,disabled:s?"disabled":"enabled"})))}}()}]),t}();t.default=d,d.propTypes=c,d.defaultProps=p},2676:function(e,t,n){},2685:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=2685},2687:function(e,t){}}]);