(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{1198:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getLayer=y;var n=f(o(1)),r=f(o(0)),i=o(2667),u=f(o(2662)),a=o(388),l=f(o(751)),s=o(2658),c=f(o(2666));function f(t){return t&&t.__esModule?t:{default:t}}var p={fillColor:"fillColor",color:"fillColor",fill:"fillColor","fill-color":"fillColor",strokeColor:"strokeColor","stroke-color":"strokeColor","stroke-width":"strokeWidth"},d=function(){return function(t,e){var o={};return Object.keys(t).forEach(function(e){e in p?o[p[e]]=t[e]:o[e]=t[e]}),"string"==typeof t.fillColor&&(o.fillColor=(0,a.hexToRGB)(t.fillColor)),"string"==typeof t.strokeColor&&(o.strokeColor=(0,a.hexToRGB)(t.strokeColor)),Object.assign({},o,e)}}(),h=void 0,v=function(){return function t(e,o,n){if(e&&e.features&&e.features.forEach(function(r){t(r,o,e.extraProps||n)}),e&&e.geometry){var r=Object.assign({},e,{properties:d(e.properties,o)});r.extraProps||(r.extraProps=n),h.push(r)}}}();function y(t,e,o,n){var r=t,u=r.fill_color_picker,a=r.stroke_color_picker,c=[u.r,u.g,u.b,255*u.a],f=[a.r,a.g,a.b,255*a.a],p={};c[3]>0&&(p.fillColor=c),f[3]>0&&(p.strokeColor=f),h=[],v(e.data,p);var d=void 0;return r.js_data_mutator&&(d=(0,l.default)(r.js_data_mutator),h=d(h)),new i.GeoJsonLayer(Object.assign({id:"geojson-layer-"+r.slice_id,filled:r.filled,data:h,stroked:r.stroked,extruded:r.extruded,pointRadiusScale:r.point_radius_scale},(0,s.commonLayerProps)(r,o,n)))}var w={formData:r.default.object.isRequired,payload:r.default.object.isRequired,setControlValue:r.default.func.isRequired,viewport:r.default.object.isRequired,onAddFilter:r.default.func,setTooltip:r.default.func},m={onAddFilter:function(){return function(){}}(),setTooltip:function(){return function(){}}()};function b(t){var e=t.formData,o=t.payload,r=t.setControlValue,i=t.onAddFilter,a=t.setTooltip,l=t.viewport,s=y(e,o,i,a);return n.default.createElement(u.default,{mapboxApiAccessToken:o.data.mapboxApiKey,viewport:l,layers:[s],mapStyle:e.mapbox_style,setControlValue:r})}b.propTypes=w,b.defaultProps=m,e.default=(0,c.default)(b)},2658:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.getBounds=l,e.fitViewport=function(t,e){var o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;try{var n=l(e);return Object.assign({},t,(0,r.fitBounds)({height:t.height,width:t.width,padding:o,bounds:n}))}catch(e){return console.error("Could not auto zoom",e),t}},e.commonLayerProps=function(t,e,o){var r=t,i=void 0,a=void 0;r.js_tooltip?a=(0,u.default)(r.js_tooltip):r.line_column&&"geohash"===r.line_type&&(a=function(){return function(t){return n.default.createElement("div",null,n.default.createElement("div",null,r.line_column,": ",n.default.createElement("strong",null,t.object[r.line_column])),r.metric&&n.default.createElement("div",null,r.metric,": ",n.default.createElement("strong",null,t.object[r.metric])))}}());a&&(i=function(){return function(t){t.picked?o({content:a(t),x:t.x,y:t.y}):o(null)}}());var l=void 0;r.js_onclick_href?l=function(){return function(t){var e=(0,u.default)(r.js_onclick_href)(t);window.open(e)}}():r.table_filter&&"geohash"===r.line_type&&(l=function(){return function(t){return e(r.line_column,[t.object[r.line_column]],!1)}}());return{onClick:l,onHover:i,pickable:Boolean(i)}};var n=a(o(1)),r=o(2670),i=a(o(55)),u=a(o(751));function a(t){return t&&t.__esModule?t:{default:t}}function l(t){var e=i.default.extent(t,function(t){return t[1]}),o=i.default.extent(t,function(t){return t[0]});return[[o[0],e[0]],[o[1],e[1]]]}},2662:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}return t},r=function(){function t(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,o,n){return o&&t(e.prototype,o),n&&t(e,n),e}}(),i=s(o(1)),u=s(o(0)),a=s(o(2686)),l=s(o(2667));function s(t){return t&&t.__esModule?t:{default:t}}o(2688);var c={viewport:u.default.object.isRequired,layers:u.default.array.isRequired,setControlValue:u.default.func,mapStyle:u.default.string,mapboxApiAccessToken:u.default.string.isRequired,onViewportChange:u.default.func},f={mapStyle:"light",onViewportChange:function(){return function(){}}(),setControlValue:function(){return function(){}}()},p=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var o=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));return o.state={viewport:t.viewport},o.tick=o.tick.bind(o),o.onViewportChange=o.onViewportChange.bind(o),o}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,i["default"].Component),r(e,[{key:"componentWillMount",value:function(){return function(){var t=setInterval(this.tick,1e3);this.setState(function(){return{timer:t}})}}()},{key:"componentWillReceiveProps",value:function(){return function(t){var e=this;this.setState(function(){return{viewport:Object.assign({},t.viewport),previousViewport:e.state.viewport}})}}()},{key:"componentWillUnmount",value:function(){return function(){this.clearInterval(this.state.timer)}}()},{key:"onViewportChange",value:function(){return function(t){var e=Object.assign({},t);delete e.width,delete e.height;var o=Object.assign({},this.state.viewport,e);this.setState(function(){return{viewport:o}}),this.props.onViewportChange(o)}}()},{key:"tick",value:function(){return function(){var t=this;if(this.state.previousViewport!==this.state.viewport){var e=this.props.setControlValue,o=this.state.viewport;e&&e("viewport",o),this.setState(function(){return{previousViewport:t.state.viewport}})}}}()},{key:"layers",value:function(){return function(){return this.props.layers.some(function(t){return"function"==typeof t})?this.props.layers.map(function(t){return"function"==typeof t?t():t}):this.props.layers}}()},{key:"render",value:function(){return function(){var t=this.state.viewport;return i.default.createElement(a.default,n({},t,{mapStyle:this.props.mapStyle,onViewportChange:this.onViewportChange,mapboxApiAccessToken:this.props.mapboxApiAccessToken}),i.default.createElement(l.default,n({},t,{layers:this.layers(),initWebGLParameters:!0})))}}()}]),e}();e.default=p,p.propTypes=c,p.defaultProps=f},2666:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u;return function(){return function(o,i,u){var l=new a(o,i,u);r.default.render(n.default.createElement(t,e(l)),document.querySelector(o.selector))}}()};var n=i(o(1)),r=i(o(10));function i(t){return t&&t.__esModule?t:{default:t}}var u=function(){return function(t){return t}}(),a=function(){return function t(e,o,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.formData=e.formData,this.payload=o,this.setControlValue=n,this.viewport=Object.assign({},this.formData.viewport,{width:e.width(),height:e.height()}),this.onAddFilter=function(){e.addFilter.apply(e,arguments)},this.setTooltip=function(){e.setTooltip.apply(e,arguments)}}}()},2685:function(t,e){function o(t){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}o.keys=function(){return[]},o.resolve=o,t.exports=o,o.id=2685},2687:function(t,e){}}]);